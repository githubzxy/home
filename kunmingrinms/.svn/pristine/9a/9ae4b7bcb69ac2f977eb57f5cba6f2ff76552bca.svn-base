define("common/date/YearPicker",["bui/common","bui/overlay","bui/list","bui/toolbar"],function(require){var BUI=require("bui/common"),Toolbar=(BUI.Component,require("bui/toolbar")),Overlay=require("bui/overlay").Overlay,List=require("bui/list").SimpleList,PREFIX=BUI.prefix,CLS_YEAR_NAV="x-monthpicker-yearnav",YearPanel=List.extend({bindUI:function(){var _self=this,el=_self.get("el");el.delegate("a","click",function(ev){ev.preventDefault()}),el.delegate(".x-monthpicker-year","dblclick",function(){_self.fire("yeardblclick")}),el.delegate(".x-icon","click",function(ev){var sender=$(ev.currentTarget);sender.hasClass(CLS_YEAR_NAV+"-prev")?_self._prevPage():sender.hasClass(CLS_YEAR_NAV+"-next")&&_self._nextPage()}),_self.on("itemselected",function(ev){ev.item&&_self.setInternal("year",ev.item.value)})},_prevPage:function(){var _self=this,start=_self.get("start"),yearCount=_self.get("yearCount");_self.set("start",start-yearCount)},_nextPage:function(){var _self=this,start=_self.get("start"),yearCount=_self.get("yearCount");_self.set("start",start+yearCount)},_uiSetStart:function(){this._setYearsContent()},_uiSetYear:function(v){var _self=this;_self.findItemByField("value",v)?_self.setSelectedByField(v):_self.set("start",v)},_setYearsContent:function(){for(var _self=this,year=_self.get("year"),start=_self.get("start"),yearCount=_self.get("yearCount"),items=[],i=start;i<start+yearCount;i++){var text=i.toString();items.push({text:text,value:i})}_self.set("items",items),_self.setSelectedByField(year)}},{ATTRS:{items:{view:!0,value:[]},elCls:{view:!0,value:"x-monthpicker-years"},itemCls:{value:"x-monthpicker-item"},year:{},start:{value:(new Date).getFullYear()},yearCount:{value:12},itemTpl:{view:!0,value:'<li class="x-monthpicker-item x-monthpicker-year"><a href="#" hidefocus="on">{text}</a></li>'},tpl:{view:!0,value:'<div class="'+CLS_YEAR_NAV+'"><span class="'+CLS_YEAR_NAV+'-prev x-icon x-icon-normal x-icon-small"><span class="icon icon-caret icon-caret-left"></span></span><span class="'+CLS_YEAR_NAV+'-next x-icon x-icon-normal x-icon-small"><span class="icon icon-caret icon-caret-right"></span></span></div><ul></ul>'}}});return Overlay.extend({initializer:function(){var _self=this,children=_self.get("children"),yearPanel=new YearPanel,footer=_self._createFooter();children.push(yearPanel),children.push(footer),_self.set("yearPanel",yearPanel)},bindUI:function(){var _self=this;_self.get("yearPanel").on("itemselected",function(ev){ev.item&&_self.setInternal("year",ev.item.value)}).on("yeardblclick",function(){_self._successCall()})},_successCall:function(){var _self=this,callback=_self.get("success");callback&&callback.call(_self)},_createFooter:function(){var _self=this;return new Toolbar.Bar({elCls:PREFIX+"clear x-monthpicker-footer",children:[{xclass:"bar-item-button",text:"确定",btnCls:"button button-small button-primary",handler:function(){_self._successCall()}},{xclass:"bar-item-button",text:"取消",btnCls:"button button-small last",handler:function(){var callback=_self.get("cancel");callback&&callback.call(_self)}}]})},_uiSetYear:function(v){this.get("yearPanel").set("year",v)}},{ATTRS:{footer:{},align:{value:{}},elCls:{value:"common-yearpicker"},year:{},success:{value:function(){}},cancel:{value:function(){}},width:{value:180},yearPanel:{}}})});